<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>因果推断专题｜序章：因果推断概述 | FGZ的主页</title><meta name="author" content="FGZ"><meta name="copyright" content="FGZ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="附件：  【附件内容】录屏 【附件下载】链接：https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1DVrQZnxCHN48iZTo2RrBqw?pwd&#x3D;kpmg     主要参考资料：  Athey S, Imbens G W. The state of applied econometrics: Causality and policy evaluation[J]. Journal of Eco">
<meta property="og:type" content="article">
<meta property="og:title" content="因果推断专题｜序章：因果推断概述">
<meta property="og:url" content="https://fgzfgz.github.io/posts/56058/index.html">
<meta property="og:site_name" content="FGZ的主页">
<meta property="og:description" content="附件：  【附件内容】录屏 【附件下载】链接：https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1DVrQZnxCHN48iZTo2RrBqw?pwd&#x3D;kpmg     主要参考资料：  Athey S, Imbens G W. The state of applied econometrics: Causality and policy evaluation[J]. Journal of Eco">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fgzfgz.github.io/img/topimage.jpg">
<meta property="article:published_time" content="2023-11-01T14:38:21.000Z">
<meta property="article:modified_time" content="2025-07-26T14:49:03.557Z">
<meta property="article:author" content="FGZ">
<meta property="article:tag" content="合成控制法">
<meta property="article:tag" content="因果推断">
<meta property="article:tag" content="视频">
<meta property="article:tag" content="回归法">
<meta property="article:tag" content="倾向得分匹配">
<meta property="article:tag" content="工具变量法">
<meta property="article:tag" content="固定效应">
<meta property="article:tag" content="双重差分法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fgzfgz.github.io/img/topimage.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://fgzfgz.github.io/posts/56058/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.sukap.cn"/><meta name="google-site-verification" content="DWWqWjPUytI3RkNWoYmrVuQ0pENnG2IHC9YmqpYv-Is"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: '',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=true"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'true');
</script><link rel="stylesheet" href="https://fgzfgz.github.io" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '因果推断专题｜序章：因果推断概述',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-07-26 22:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">91</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/BiliBili/"><i class="fa-fw fas fa-brands fa-bilibili"></i><span> 视频</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Share/"><i class="fa-fw fas fa-solid fa-file-arrow-down"></i><span> 资源共享</span></a></li><li><a class="site-page child" href="/Favorites/"><i class="fa-fw fas fa-bookmark"></i><span> 收藏集锦</span></a></li><li><a class="site-page child" href="/DataCleaning/"><i class="fa-fw fas fa-laptop"></i><span> 数据清洗</span></a></li><li><a class="site-page child" href="/EmpiRes/"><i class="fa-fw fas fa-chart-line"></i><span> 实证分析</span></a></li><li><a class="site-page child" href="/Data/"><i class="fa-fw fas fa-database"></i><span> 数据相关</span></a></li><li><a class="site-page child" href="/Economics/"><i class="fa-fw fas fa-solid fa-book-open"></i><span> 经济学笔记</span></a></li><li><a class="site-page child" href="/DevelopmentEconomics/"><i class="fa-fw fas fa-solid fa-book-open"></i><span> 发展经济学笔记</span></a></li><li><a class="site-page child" href="/Sustainable/"><i class="fa-fw fas fa-solid fa-seedling"></i><span> 可持续发展</span></a></li><li><a class="site-page child" href="/Opinion/"><i class="fa-fw fas fa-lightbulb"></i><span> 经济思考</span></a></li><li><a class="site-page child" href="/Software/"><i class="fa-fw fas fa-brands fa-uncharted"></i><span> 软件</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-solid fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/img/topimage.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="FGZ的主页"><span class="site-name">FGZ的主页</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/BiliBili/"><i class="fa-fw fas fa-brands fa-bilibili"></i><span> 视频</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Share/"><i class="fa-fw fas fa-solid fa-file-arrow-down"></i><span> 资源共享</span></a></li><li><a class="site-page child" href="/Favorites/"><i class="fa-fw fas fa-bookmark"></i><span> 收藏集锦</span></a></li><li><a class="site-page child" href="/DataCleaning/"><i class="fa-fw fas fa-laptop"></i><span> 数据清洗</span></a></li><li><a class="site-page child" href="/EmpiRes/"><i class="fa-fw fas fa-chart-line"></i><span> 实证分析</span></a></li><li><a class="site-page child" href="/Data/"><i class="fa-fw fas fa-database"></i><span> 数据相关</span></a></li><li><a class="site-page child" href="/Economics/"><i class="fa-fw fas fa-solid fa-book-open"></i><span> 经济学笔记</span></a></li><li><a class="site-page child" href="/DevelopmentEconomics/"><i class="fa-fw fas fa-solid fa-book-open"></i><span> 发展经济学笔记</span></a></li><li><a class="site-page child" href="/Sustainable/"><i class="fa-fw fas fa-solid fa-seedling"></i><span> 可持续发展</span></a></li><li><a class="site-page child" href="/Opinion/"><i class="fa-fw fas fa-lightbulb"></i><span> 经济思考</span></a></li><li><a class="site-page child" href="/Software/"><i class="fa-fw fas fa-brands fa-uncharted"></i><span> 软件</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-solid fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">因果推断专题｜序章：因果推断概述</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-01T14:38:21.000Z" title="发表于 2023-11-01 22:38">2023-11-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-26T14:49:03.557Z" title="更新于 2025-07-26 22:49">2025-07-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%A7%86%E9%A2%91%E5%90%88%E9%9B%86/">视频合集</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="因果推断专题｜序章：因果推断概述"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p><strong>附件：</strong></p>
<ul>
<li>【附件内容】录屏</li>
<li>【附件下载】链接：https://pan.baidu.com/s/1DVrQZnxCHN48iZTo2RrBqw?pwd=kpmg</li>
</ul>
</blockquote>
<hr />
<blockquote>
<p><strong>主要参考资料：</strong></p>
<ol type="1">
<li>Athey S, Imbens G W. The state of applied econometrics: Causality
and policy evaluation[J]. <em>Journal of Economic perspectives</em>,
2017, 31(2): 3-32.</li>
<li>赵西亮. 基本有用的计量经济学[M]. 北京: 北京大学出版社, 2017.</li>
<li>乔舒亚·安格里斯特, 约恩-斯特芬·皮施克.
基本无害的计量经济学实证研究者指南[M]. 上海: 格致出版社, 2012.</li>
</ol>
</blockquote>
<h1 id="一识别策略">一、识别策略</h1>
<h2 id="为何需要因果识别">1. 为何需要因果识别</h2>
<p>在理想条件下，对于同一个体，如果能同时观测到实行干预和不实行干预的结果，这两种结果的差异就是这种干预行为的因果效应。然而，现实情况往往是只能观测到一种状态的结果，如果选择干预，就无法观测到未干预的结果，因此无法直接观察到干预行为的因果效应。</p>
<p>为了准确估计干预行为的效果，同时避免潜在结果不可测导致的问题，效仿自然科学的实验研究是一种比较好的选择。在保证干预组与控制组的个体之间几乎无差异的情况下，控制其他的所有因素不变，仅改变某一特定因素，改变该要素的一组是干预组
(treated group)，不改变该要素的一组是控制组 (controlled
group)。比较干预组与控制组之间的差别，即可说明这种干预行为的效果。</p>
<p>然而，受制于法律、伦理道德或实验的可行性，用准自然实验的方式进行因果推断往往不具有可行性。绝大多数研究使用观测数据进行因果推断，少数研究也使用准自然实验与观测数据结合的方式进行因果推断。因此，占绝大多数的、基于观测数据开展的研究往往面临上述的仅能观测到一种结果的“因果推断的基本问题”
(Holland, 1986)，使用适当的因果识别策略就显得尤为重要。</p>
<h2 id="基本构成要件">2. 基本构成要件</h2>
<p>潜在结果框架有三个基本构成要件，即<strong>潜在结果</strong>、<strong>稳定性假设</strong>与<strong>分配机制</strong>。</p>
<h3 id="潜在结果">2.1 潜在结果</h3>
<p>用<span class="math inline">\(D_i\)</span>表示对个体 <span
class="math inline">\(i\)</span> 是否实施某种干预行为，当实施干预行为
(<span class="math inline">\(D_i=1\)</span>) 时，可以观测潜在结果 <span
class="math inline">\(Y_{1i}\)</span>；当没有实施干预行为时 (<span
class="math inline">\(D_i=0\)</span>) ，可以观测到潜在结果。</p>
<p><span class="math display">\[
\begin {align}
Y_i = &amp; D_i Y_{1i} + (1-D_i) Y_{0i}
= &amp; \left \{
\begin {array} {lr}
Y_i=Y_{1i} , \ \ \ \ if \ \ D_i=1  \\
Y_i=Y_{0i},  \ \ \ \ if \ \ D_i=0    \\
\end {array}
\right .
\end {align}
\]</span></p>
<h3 id="稳定性假设">2.2 稳定性假设</h3>
<p>稳定性假设 (Stable unit-treatment value assumption, SUTVA)
要求干预行为对个体的影响是稳定的。具体来看主要包括以下两个方面：</p>
<p>第一，个体之间的潜在结果没有相互影响，每个个体的潜在结果相互独立。这避免了干预行为或非干预行为的外溢对潜在结果估计的扭曲。</p>
<p>第二，对每个干预组个体要实行相同的干预性为。例如讨论培训对收入的影响，将多种不同的培训均视作干预行为，严格意义上不满足该条件。</p>
<h3 id="分配机制">2.3 分配机制</h3>
<p>分配机制对因果效应的估计也十分重要。分配机制解决什么样本应当进入干预组，什么样本应当进入控制组。</p>
<p>由于存在无法同时观测干预与不干预行为的潜在结果，在考虑分配机制问题时，应当要考虑不受干预行为影响的两类因素：</p>
<ul>
<li><strong>个体属性</strong>：不随干预状态变化而变化的因素，以年龄等个人特征最为常见</li>
<li><strong>干预的前定因素</strong>：发生在干预性为之前的相关协变量，例如干预性为之前的收入等</li>
</ul>
<p>在基于随机化实验开展的研究中，分配机制是明确的；但在基于观测数据开展的研究中，干预组与控制组往往并非由研究人员分配，分配机制是未知的，此时进行因果识别的重要问题就是识别出未知的分配机制。</p>
<p>非混杂性假设 (Unconfoundedness Assumption)
表示所有可能影响到潜在结果的因素都可以被观测到，不存在不可观测的混在因素对潜在结果的估计产生影响，即：</p>
<p><span class="math display">\[
\begin {align}
(Y_{0i},Y_{1i}) \perp D_i  \ | \ X_i
\end {align}
\]</span></p>
<p>也就是说，在控制协变量 <span class="math inline">\(X_i\)</span>
后，干预行为与潜在结果独立。</p>
<p>因此，分配机制可以分为三类：</p>
<ul>
<li>已知分配机制，且满足非混杂性假设：随机化实验</li>
<li>未知分配机制，且满足非混杂性假设：规则分配机制 (例如 PSM)</li>
<li>其他情况：不规则机制</li>
</ul>
<h1 id="二随机化实验与回归法">二、随机化实验与回归法</h1>
<h2 id="随机化实验">1. 随机化实验</h2>
<p>在随机化实验中，样本被随机分配到干预组与控制组，因此分配机制不依赖于潜在结果，满足非混杂性假设。</p>
<p><span class="math display">\[
\begin {align}
(Y_{0i},Y_{1i}) \perp D_i
\end {align}
\]</span></p>
<p>因此，随机化实验中，干预组与控制组的观测结果之差即可解释为因果效应。</p>
<p>随机化实验可以分为四类：</p>
<ul>
<li>伯努利实验 (Bernoulli Trials)</li>
<li>完全随机化实验 (completely randomized experiments)</li>
<li>分层随机实验 (stratified randomized experiments)</li>
<li>配对随机化实验 (paried randomized experiments)</li>
</ul>
<p>伯努利实验在同样的条件下重复地、相互独立地进行随机试验，其特点是该随机试验只有两种可能结果：发生或者不发生。</p>
<p>但是伯努利实验有可能出现所有样本均在干预组或控制组中，导致无法通过比较干预组与控制组进行因果推断。</p>
<p>完全随机实验要求事先设定干预组个体数量 <span
class="math inline">\(N_t\)</span>，剩下的 <span
class="math inline">\(N-N_t\)</span> 进入控制组。</p>
<p>分层随机实验则在完全随机实验的基础上，依据某些对潜在结果影响较大的因素进行分层，在层内实行完全随机化实验。</p>
<p>配对随机化实验是一种特殊的分层随机化实验，将所有个体分成 <span
class="math inline">\(N /2\)</span>
组，每一组只有两个个体，且一个在干预组，一个在控制组。</p>
<p>在分层随机化实验中，也要求非混杂性假设或条件独立性假设 CIA 成立，即
<span class="math inline">\((Y_{0i},Y_{1i}) \perp D_i  \  |
\  X_i\)</span>。</p>
<p>由于随机化实验要求所有个体被随机分配到干预组与控制组，干预状态不是个体选择的结果，随机化实验的结构解释为总体的平均因果效应。然而在现实中，干预行为往往与个体选择有关，使用随机化实验得到的结果并不一定是现实中干预行为的因果效应。</p>
<h2 id="回归法">2. 回归法</h2>
<p>回归分析本质是相关性分析，而非因果效应的估计。因此，基于观测数据使用回归法进行因果效应估计时，需要满足一定的条件。</p>
<p>在随机化实验中，干预组与控制组的潜在结果差异即为因果效应。然而，在满足稳定性假设的条件下，使用随机抽样的观测数据进行因果效应识别时，由于处理效应
<span class="math inline">\(Y_{1i}-Y_{0i}\)</span>
是一个随机变量，我们一般更加关注平均因果效应。</p>
<ul>
<li>平均处理效应 ATE (Average Treatment Effect)</li>
<li>平均处理效应 ATT / ATET (Average Treatment Effect on Treated)</li>
</ul>
<p><span class="math display">\[
\begin{align} ATE &amp; \equiv E(Y_{1i}-Y_{0i}) \\ ATT &amp; \equiv
E(Y_{1i}-Y_{0i} \ | \ D_i=1) \end {align}
\]</span></p>
<p>因此，有如下关系：</p>
<p><span class="math display">\[
\begin {align}  
E(Y_{1i} \ | \ D_i=1) &amp; - E(Y_{0i} \ | \ D_i=0) =   \notag \\
&amp; [ E(Y_{1i} \ | \ D_i=1) -E(Y_{0i} \ | \ D_i=1) ] + [ E(Y_{0i} \ |
\ D_i=1) -E(Y_{0i} \ | \ D_i=0) ] \end{align}
\]</span></p>
<p>其中：等式左边为 ATE，右边第一项为 ATT，第二项为选择偏差。</p>
<p>对于二元的处理变量，使用基于极大似然法的 probit 与 logit 模型
(非线性概率模型)，可以克服线性概率模型的拟合的结果可能不在 [0,1]
之间的问题。</p>
<p>使用线性回归进行因果效应估计时，必须满足以下两个条件同时成立。</p>
<p><span class="math display">\[
\begin {align}  E(Y_{0i} \ | \ D_i=1) = E(Y_{0i} \ | \
D_i=0)   \\   E(Y_{1i} \ | \ D_i=1) = E(Y_{1i} \ | \ D_i=0)   \end
{align}
\]</span></p>
<h1 id="三匹配法">三、匹配法</h1>
<p>倾向得分匹配主要用于解决未知分配机制的问题，当满足非混杂性假设时，使用
PSM
可以准确识别因果效应。但当不满足非混杂性假设，即存在不可观测变量的影响时，使用
PSM 不能消除不可观测变量的影响，估计结果是受到扭曲的因果效应。</p>
<h2 id="前提假设">1. 前提假设</h2>
<p>使用匹配法进行因果识别，应当满足以下几个条件：</p>
<ul>
<li>条件独立性假设 CIA：<span class="math inline">\((Y_{0i},Y_{1i})
\perp D_i \  | \ X_i\)</span></li>
<li>共同区间假设 (Common Support)：<span
class="math inline">\(0&lt;Pr(D_i
=1)&lt;1\)</span>，即倾向得分的取值在0~1之间</li>
</ul>
<h2 id="估计步骤">2. 估计步骤</h2>
<p>匹配方法的估计包括四个步骤：</p>
<ul>
<li>定义相似性</li>
<li>实施匹配</li>
<li>评价匹配效果</li>
<li>估计因果效应</li>
</ul>
<h3 id="定义相似性">2.1 定义相似性</h3>
<p>相似性的定义包括了两个环节：</p>
<ul>
<li><p>选择协变量：协变量的选择应当满足条件独立性假设，干预组与控制组之间没有未观测到的差异。</p>
<ul>
<li>遗漏变量可能会造估计结果的偏差</li>
<li>添加与干预变量无关的变量不会影响估计结果</li>
</ul></li>
<li><p>测度相似性：通常使用欧氏距离或马氏距离衡量</p></li>
</ul>
<p>在倾向得分匹配中，常使用平衡性检验检查干预组和控制组的协变量均值差异，以检验条件均值独立性假设是否成立
(条件独立性假设难以验证，检验条件均值独立性假设是否成立是一种证伪检验)。</p>
<h3 id="实施匹配">2.2 实施匹配</h3>
<p>匹配的方式分为：</p>
<ul>
<li><p>近邻匹配</p>
<ul>
<li>一对一匹配</li>
<li>一对多匹配：半径匹配、马氏匹配等</li>
</ul></li>
<li><p>分层匹配</p></li>
<li><p>核匹配</p></li>
</ul>
<h3 id="评价匹配效果">2.3 评价匹配效果</h3>
<ul>
<li>标准化平均值差异</li>
<li>对数标准差比</li>
<li>倾向指数的标准化平均值差异</li>
<li>图示：倾向得分分布图、分位数分布图、标准化平均值差异变化图</li>
</ul>
<h3 id="估计因果效应">2.4 估计因果效应</h3>
<p>对于不同的匹配方式，估计因果效应的方法不同。</p>
<h1 id="四工具变量法">四、工具变量法</h1>
<p>如上文所述，在因果效应识别时，应当满足无混杂性假设。然而在现实中，无混杂性假设很难被满足。例如在探究教育年限
<span class="math inline">\(D\)</span> 对收入 <span
class="math inline">\(Y\)</span> 的影响时，学生的能力 <span
class="math inline">\(A\)</span>
可能是一种混杂因素，即学生的能力越强，其接受教育的年限可能越高，同时收入也可能会越大。传统
PSM
法估计无法解决学生能力等内部混杂因素与政策环境等外部混杂因素对因果识别结果的扭曲，这也是工具变量法区别于
PSM 的关键。</p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/net-img-image-20221018182903-oq4blvn-20221021221423-dp6aln3.png" style="height:130px" alt="工具变量法的有相无环图" /></p>
<p>在工具变量法 (右图 b) 中，有向无环图如下所示，如果存在一个工具变量
<span class="math inline">\(Z\)</span>
满足相关性与外生性的条件，就可以消除混杂因素 <span
class="math inline">\(A\)</span> 对结果的扭曲。</p>
<ul>
<li>相关性：<span class="math inline">\(Cov(D_i, Z_i) \ne
0\)</span>，即工具变量 <span class="math inline">\(Z\)</span>
与核心解释变量 <span class="math inline">\(D\)</span> 相关</li>
<li>外生性：<span class="math inline">\(Cov(\eta_i, Z_i) =
0\)</span>，即工具变量与 <span class="math inline">\(Z\)</span>
与包含混杂因素 <span class="math inline">\(A\)</span> 的残差项 <span
class="math inline">\(\eta\)</span> 不相关，其中 <span
class="math inline">\(\eta_i = A^{&#39;}_i \gamma +v_i\)</span>。( <a
target="_blank" rel="noopener" href="https://www.lianxh.cn/news/541a6992f92b0.html"
title="工具变量的外部有效性">工具变量的外部有效性</a> )</li>
</ul>
<p>工具变量可以消除混杂因素影响的原理是：</p>
<p>阻断后门路径 <span class="math inline">\(D \leftarrow A \rightarrow
Y\)</span>，从其中分离出 <span class="math inline">\(D \rightarrow
Y\)</span>。</p>
<p>在实证中，为保证因果效应被准确识别，如果存在 <span
class="math inline">\(m\)</span> 个混杂因素，应当需要不少于 <span
class="math inline">\(m\)</span> 个工具变量。</p>
<h1
id="五固定效应双重差分与合成控制">五、固定效应、双重差分与合成控制</h1>
<p>上述的回归法、匹配法是基于截面数据，其正确估计因果效应的基础都是要满足非混杂性假设
/
条件独立性假设。但观测数据往往不能涵盖所有的可能影响因素，当存在混杂因素影响时，条件独立性假设不再被满足，可以使用工具变量法，基于阻断后门路径的方式实现因果推断。但工具变量往往很难寻找，且存在一定的工具变量滥用问题。</p>
<p>在面板数据与重复截面数据中，固定效应、双重差分与合成控制等方式可用于因果效应的识别。</p>
<h2 id="固定效应法">1. 固定效应法</h2>
<p>使用固定效应法估计因果效应，应当满足面板数据下的条件独立性假设：</p>
<p><span class="math display">\[
\begin {align}    (Y_{1it},Y_{0it}) \perp D_{it} \ | \ X_{it} , \ U_i, \
t  \end{align}
\]</span></p>
<p>如上所示，<span class="math inline">\(X_{it}\)</span>
表示可观测得混杂因素；<span class="math inline">\(U_{it}\)</span>
表示<strong>不随时间变化的</strong>不可观测混杂因素，<span
class="math inline">\(t\)</span> 表示时间。</p>
<p>因此，当满足上述条件后，所有随时间变化的混杂因素都可以被观测，通过控制可观测的混杂因素，就可以消除混杂因素对因果效应估计结果的扭曲，得到总体干预组的平均因果效应
ATT。不随时间变化的混杂因素的影响 (即固定效应)
可以通过<strong>均值法</strong>或<strong>差分法</strong>消除。</p>
<p>固定效应中涉及的差分法，是干预行为的“事前”与“事后”的差分。</p>
<h2 id="双重差分法">2. 双重差分法</h2>
<p>固定效应法可以消除不随时间变化的混杂因素影响，然而当结果变量发生了结构性变化，例如
2008
年的次贷危机，导致次贷危机发生前与发生后中国的经济结构发生了很大变化。此时，若仅满足固定效应法的条件独立性假设，不能克服结构性变化带来的影响。</p>
<p>考虑到在时间维度上，控制组可能也受到相同因素的影响，干预组与控制组可能发生类似的结构性变化，因此，通过双重差分的方式，即可控制这种结构性变化带来的影响。</p>
<p><strong>双重差分：</strong>“事前”与“事后”的差分，干预组与控制组的差分。</p>
<h3 id="基本假设">2.1 <strong>基本假设：</strong></h3>
<ul>
<li><strong>共同趋势假设：</strong>干预组与控制组受到相同变动趋势的影响</li>
<li><strong>共同区间假设：</strong><span class="math inline">\(Pr(D_i
=1) \gt 0\)</span>且 <span class="math inline">\(Pr(D_iT_t=1 \ | \
X_{it})&lt;1\)</span>，即总体中同时存在干预组与控制组个体</li>
<li><strong>外生性假设：</strong><span
class="math inline">\(X_{1it}=X_{0it}=X_{it}\)</span>
，<strong>即协变量外生于干预政策。因此，协变量 <span
class="math inline">\(X_{1it}\)</span>应该是发生在政策干预实施之前
(前定变量)</strong> 或者<strong>不随干预政策发生变化的变量</strong></li>
<li><strong>SUVTA：</strong>干预政策只影响干预组，不会对控制组产生影响，这保证了干预政策没有溢出效应。</li>
</ul>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/Untitled-20221021173451-z16resu.png" style="height:300px" alt="" /></p>
<p>图示：</p>
<ul>
<li><span class="math inline">\(AC \parallel
DE\)</span>：即为满足共同趋势假设</li>
<li><span class="math inline">\(AC\)</span> 与 <span
class="math inline">\(DE\)</span> 的距离即为干预组与控制组的差距；</li>
<li><span class="math inline">\(BC\)</span> 即为因果效应。</li>
</ul>
<h3 id="检验">2.2 检验</h3>
<h4 id="平行趋势检验">2.2.1 平行趋势检验</h4>
<p>在实际研究中，进行 DID 回归，一般要进行平行趋势检验，例如，在 Zhu et
al. 的 <em>Removing the "Hats of Poverty": Effects of ending the
national poverty county program on fiscal expenditures
​</em>一文中，使用了多种方式进行平行趋势检验：</p>
<ul>
<li>使用数据的均值走向图，试图论证在政策实施前，试点与非试点地区的经济情况具有平行关系。</li>
</ul>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021183831-557pmtn.png" style="height:300px" alt="" /></p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021183851-bvj5url.png" style="height:300px" alt="" /></p>
<ul>
<li>对面板数据进行逐年回归，通过回归系数的大小与显著性比较论证平行趋势的存在。</li>
</ul>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021184222-nilyr7s.png" style="height:300px" alt="" /></p>
<ul>
<li>通过事件研究法的结果图示展现平行趋势，在政策执行前，回归系数的置信区间包含0；政策执行后，回归系数的置信区间不再包含0。</li>
</ul>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021184301-0qc5afi.png" style="height:300px" alt="" /></p>
<h4 id="安慰剂检验">2.2.2 安慰剂检验</h4>
<p>安慰剂检验主要包括两种方法，一是更改政策干预时间，二是构造伪样本组。例如，将政策干预时间设定为实际干预前的<span
class="math inline">\(t-2\)</span>期，如果系数不显著，可以认为将<span
class="math inline">\(t-2\)</span>期设定为政策干预时间是不合适的；反之，如果系数显著，可以认为基准回归的显著结果可能是其他政策或者非政策的外部环境变化带来的。</p>
<p>一些学者也通过置换检验的方式 (permutation test)，对 DID
进行了安慰剂检验，例如，石大千等发表于《中国工业经济》的《智慧城市建设能否降低环境污染》，随机抽取控制组中的部分样本作为“伪干预组”，用于证伪“假干预”行为没有政策效果。</p>
<h2 id="合成控制法">3. 合成控制法</h2>
<p>干预组与控制组之间的相似度足够高，是使用双重差分法保证平行趋势的重要条件。当控制组与干预组中的个体都不相似时，可以对多个控制组个体赋予不同的权重，计算加权平均值，构造出一个合成的控制组，这使得合成控制组与干预组在发生干预行为之前的状态非常相似。干预组与合成控制组的差异即为因果效应。</p>
<p><strong>特点：</strong>干预组个体往往只有一个，例如一个城市、地区或者国家</p>
<h3 id="基本假设-1">3.1 <strong>基本假设：</strong></h3>
<ul>
<li>干预组与控制组无交互影响</li>
<li>构造合成控制组时，两组个体的协变量必须是前定变量或不受政策干预影响的变量</li>
<li>各控制组的权重非负，且和为 1</li>
</ul>
<h3 id="例子">3.2 <strong>例子</strong></h3>
<p>以 Abadie et al. (2010) 的加州香烟控制项目对香烟消费的影响为例，1988
年 11 月，加州政府通过了香烟控制项目，每包烟的消费税提高 25 美分，于
1989 年 1 月开始生效。作者将加州作为干预组，将美国未出台香烟管控政策的
38 个州作为控制组，考察消费税增加对年度人均香烟消费量的影响。</p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20231101233027-6j5rii4.png" alt="" /></p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20231101233047-z4tuthx.png" alt="" /></p>
<p>可以发现，通过合成控制法，可以实现未实施政策干预时干预组与合成控制组基本重合，若不实行香烟管控政策，加州的变化趋势应当与合成控制组的曲线完全重合。但实施了香烟管控政策的加州，人均香烟消费量明显更低，与合成加州有明显的差距，这表明改政策具有明显的降低香烟消费的效果，且随着时间的推移下降效果更加明显。</p>
<h3 id="检验-1">3.3 检验</h3>
<p>类似于 DID，合成控制法也需要进行平行趋势检验与安慰剂检验。</p>
<p>在合成控制法中，平行趋势关系已在图中展示，因此不需要额外检验。</p>
<p><strong>安慰剂检验方法：</strong></p>
<ul>
<li>置换检验：在控制组中抽取样本作为“假干预组”</li>
<li>伪干预时间：更改干预时间，检验是否在真实的干预时间处有政策效果，或在当前伪干预时间处没有政策效果。</li>
</ul>
<h2 id="回归合成控制法">4. 回归合成控制法</h2>
<p>合成控制法要求控制组个体的权重为非负，且和为
1。在此条件下可能无法构造出与干预组非常相似的合成控制组。</p>
<p>因此回归合成法放宽了该条件。回归合成控制法利用截面个体之间的相关性进行干预组个体受政策干预后的反事实结果，并允许群众某个控制组个体的权重为负，并且允许存在常数项，以修正合成控制组和干预组之间的差异。</p>
<p>回归合成控制法中，控制组的选择影响了估计精度。进入模型的控制组个体越多，模型自由度损失越多，精度越差。</p>
<p><strong>例子：</strong></p>
<p>萧政 (Hsiao et al., 2012) 考察 1997 年香港回归与 2003
年签署的《内地与香港关于建设更紧密经贸关系的安排》(CEPA)
对香港经济的影响。</p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20231101233101-g0hpwn8.png" style="height:350px" alt="" /></p>
<p>通过回归合成控制法，可以发现 1997 年香港回归没有显著影响香港经济，而
CEPA 对香港经济有显著的促进作用。</p>
<h1 id="六断点回归">六、断点回归</h1>
<p><strong>参考：</strong>​<a
target="_blank" rel="noopener" href="https://rdpackages.github.io"><strong>RD Packages - Regression
Discontinuity Designs (Calonico et al.)</strong></a></p>
<h2 id="适用条件与假设">1. <strong>适用条件与假设</strong></h2>
<h3 id="使用条件">1.1 使用条件</h3>
<ul>
<li>可观测的配置变量 (forcing variable):
用于断点识别的外生变量，例如生日、年龄、分数、地理位置等（<a
target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/nRG1Hg67OEoHVgeNeYgPrw">原文链接</a>）。</li>
<li>配置变量在某一阈值附近的变化，会使得处理变量的取值发生不连续变化，配置变量取值在阈值一侧的样本为干预组，另一组则为控制组。</li>
</ul>
<h3 id="假设">1.2 假设</h3>
<ul>
<li>断点假设：个体分配的概率在临界值附近有跳跃，即断点存在</li>
<li>连续性假设：除临界值附近外，控制了协变量的潜在结果期望值连续变化，即在断点附近，估计潜在结果时协变量的影响可以忽略不记。(类比
PSM 平衡性检验)</li>
<li>局部随机化假设：在临界值附近，配置变量 <span
class="math inline">\(X\)</span>
的取值应当近似于随机化实验，不受到其他不可测因素 <span
class="math inline">\(U\)</span> 的影响，不存在 <span
class="math inline">\(U\rightarrow X\)</span> 的影响路径，因此配置变量
<span class="math inline">\(X\)</span> 可以作为判断样本是否受到干预
<span class="math inline">\(D\)</span>
的依据。也就是说，在实证中需要满足 <span
class="math inline">\(X\)</span> 是严格外生的条件。</li>
<li>独立性假设：决定干预组与控制组的断点严格外生，不会与潜在结果或个人因素相互影响。</li>
<li>单调性假设：断点对所有个体的影响方向相同，即若正向单调性成立，则
<span class="math inline">\(D_{1i}&gt;D_{0i}\)</span>。</li>
</ul>
<h2 id="类型">2. <strong>类型</strong></h2>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20231101233120-fkke9vk.png" style="height:200px" alt="RDD 因果图" /></p>
<ul>
<li><strong>精确断点 (Sharp RDD)：</strong>在断点 <span
class="math inline">\(D=c\)</span> 处，个体的受干预概率从 0 跳跃为
1；</li>
<li><strong>模糊断点 (Fuzzy RDD)：</strong>在断点 <span
class="math inline">\(D=c\)</span> 处，个体的受干预概率从 <span
class="math inline">\(a\)</span> 跳跃为 <span
class="math inline">\(b\)</span>，且 <span
class="math inline">\(0&lt;a&lt;b&lt;1\)</span></li>
<li><strong>弯折回归设计 (Regression Kink Design):</strong>
当二元的处理变量在断点处不是间断性跳跃，而是弯折时，在满足平滑性假设下，可以使用弯折识别因果效应。</li>
</ul>
<p><strong>与匹配法的异同点：</strong></p>
<ul>
<li>条件独立性假设 CIA 仍然成立，<span
class="math inline">\((Y_{0i},Y_{1i}) \perp D_i \ | \
X_i\)</span>，即在控制协变量 <span class="math inline">\(X_i\)</span>
后，处理变量不影响潜在结果。</li>
<li>共同区间假设不再成立，因为当配置变量取值超过阈值时，所有样本都会被进入干预组，受到干预行为的概率是
<span class="math inline">\(1\)</span>，而不再是在 <span
class="math inline">\((0,1)\)</span> 区间内。</li>
</ul>
<p>在上述条件下，使用回归法或者匹配法估计的因果效应是不准确的。</p>
<h2 id="使用断点回归的四个关键点">3. 使用断点回归的四个关键点：</h2>
<ul>
<li><p><strong>使用局部线性估计</strong> (Porter,
2003)，以纠正在临界值附近数据跳跃发生的系统性变化</p></li>
<li><p><strong>带宽的选择问题</strong>：估计精度(估计方差)
与估计偏差的权衡问题</p>
<ul>
<li><p>干预行为的影响是异质性的，由于单调性假设，离断点越远的点，与断点处的异质性越强。</p>
<ul>
<li>若带宽较大，估计精度会提高，但样本相似度降低，估计偏差会增大</li>
<li>若带宽较小，估计精度会降低，样本相似度会提高，估计偏差会减小</li>
</ul></li>
<li><p>局部线性回归的带宽建议使用估计量在带宽极小值附近的渐进扩展 (IK
最优带宽和 CCT 最优带宽)</p></li>
</ul></li>
<li><p><strong>模型设定检验</strong></p>
<ul>
<li><strong>伪断点检测：</strong>将配置变量其他取值作为临界点，检验其他断点的处理效应是否为
0。如果不为 0，则 RDD
可能有问题，断点结果可能是不可观测因素的混杂效应导致的</li>
<li><strong>配置变量的不连续性检测：</strong>如果断点处配置变量分布是连续的，说明配置变量临界值处的个体没有操纵参考变量的能力。</li>
<li>带宽选择的敏感性检验。如果带宽的选择对结果的影响较大，则 RDD
可能有问题</li>
<li>协变量连续性检验 / 伪结果检验：以协变量作为伪结果，检测 RDD
估计量是否显著，如果显著，说明协变量不满足连续性假设。(类比 PSM
平衡性检验)</li>
</ul></li>
<li><p><strong>在不同的子样本中检验结果</strong></p></li>
</ul>
<h2 id="例子-1">4. 例子</h2>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/net-img-image-20221018223140-o8ktr2r-20221021221423-s49xzl9.png" style="height:300px" alt="" /></p>
<p>研究美国某一党派在上次胜选后，是否会影响下一次胜选的概率。</p>
<p>选票份额差距为 0 即为断点，断点右侧，民主党选票超过了
50%，与断点左侧民主党选票低于 50% 有明显断点。若民主党上一次胜选 (图 a
断点右侧)，本次选举胜选的可能性会更高 (图 b 断点右侧)。</p>
<h2 id="检验-2">5. 检验</h2>
<p>在断点回归中，更换断点 (配置变量临界值)
是进行安慰剂检验的方式之一。</p>
<p>断点回归的关键识别条件是个体不能精确控制临界点。如果个体可以操纵临界点，可能使断点左右个体分布差异很大，因此可以使用绘制配置变量分布图的方式检验配置变量的独立性问题。</p>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021191155-nuy0zwl.png" style="height:300px" alt="" /></p>
<p>例如，前一期民主党选票的份额和配置变量的关系图 (上图)
中，临界点处没有发生明显跳跃，说明上一期民主党选票份额这一协变量不会影响配置变量的取值。</p>
<h1 id="七其他方法">七、其他方法</h1>
<h2 id="多值处理变量的因果效应估计">1. 多值处理变量的因果效应估计</h2>
<p>上述内容主要针对二分类的处理变量，满足稳定性假设。然而，许多干预行为并不仅是“是否受到干预”的问题，还有干预强度的差异。</p>
<p>最常见的解决这类问题的方法是使用广义倾向得分法来解决多值离散变量或连续变量的干预因果效应问题。</p>
<p>广义倾向得分法的相关研究主要针对截面数据中非二值处理变量的因果效应问题。以
Barbara et al. (2014) 基于 Hirano and Imbens (2004) 开发的 glmdose
命令为例，其基本思路是：</p>
<ul>
<li>平衡性检验：基于干预强度变量取值，划分多层样本，并比较层内干预组与控制组的协变量均值差异；</li>
<li>计算广义倾向得分
(GPS)：满足平衡性检验以后，基于协变量估计处理强度的条件概率密度</li>
<li>构造条件期望：基于干预变量与 GPS 值计算潜在产出的条件期望模型</li>
<li>设置估计精度：用户设置估计干预变量的步长，用户控制估计精度</li>
<li>剂量反应函数：基于构造潜在产出的条件期望模型与设置的步长，估计剂量反应函数，并绘制剂量反应函数图。</li>
</ul>
<p><img src="https://assets.b3logfile.com/siyuan/1634272634187/assets/image-20221021175931-1536omm.png" style="height:250px" alt="" /></p>
<p>图片来源：《“减碳”政策制约了中国企业出口吗》《中国工业经济》</p>
<p>由此可见，GPSM 法与传统 PSM 法之间存在关联与区别：</p>
<ul>
<li><p><strong>关联：</strong></p>
<ul>
<li>在每一组内，协变量需要满足非混杂性假设</li>
<li>基于协变量的取值计算倾向得分，并作为匹配的依据</li>
</ul></li>
<li><p><strong>区别：</strong></p>
<ul>
<li>倾向得分的计算方式不同</li>
<li>组内匹配的方式也有所不同</li>
<li>需要用户设置步长，以确定估计的精度水平</li>
<li>结果不再关注干预组与控制组之间的平均处理效应，而是剂量反应函数的变化趋势</li>
</ul></li>
</ul>
<p>但是，在使用该类方法进行因果推断时，仍然面临一个问题：当时用面板数据考察连续变量的干预效果时，仍然将其当做截面数据进行估计，丧失了面板数据存在时间趋势与固定效应进而可以消除不随时间变化的不可观测因素影响的优势。例如，《中国工业经济》中曾刊载《“减碳”政策制约了中国企业出口吗》一文，使用
doseresponse2 命令 (glmdose 命令的前身) 估计
面板数据中连续处理变量的因果效应。</p>
<h2 id="社会网络中的因果效应识别">2. 社会网络中的因果效应识别</h2>
<p>在社会学的相关研究中，“同侪效应”是因果效应识别的重要问题。即某人的受干预行为会因模仿等原因受到身边同类型人群（如同龄人）受干预行为的影响，这导致在因果识别问题中的稳定性假设
SUTVA 这一基本假设不再成立。</p>
<p>Manski (1993) 提出同侪效应包括三种：</p>
<ul>
<li>关联同侪效应</li>
<li>外生同侪效应</li>
<li>内生同侪效应</li>
</ul>
<p>这三种效应的识别依赖很强的假设，且部分假设难以符合现实。</p>
<h2 id="机器学习">3. 机器学习</h2>
<p>‍机器学习在因果推断中的应用，主要有三种方法：</p>
<ul>
<li><p>双重选择程序 (Belloni et al., 2013)</p>
<ul>
<li>使用LASSO回归选择与结果相关的协变量</li>
<li>选择与干预变量相关的协变尽量</li>
<li>选取上述两组协变量的并集，并带入OLS</li>
</ul></li>
<li><p>模拟随机试验 (Hainmueller, 2012; Graham et al., 2012 &amp;
2016)</p>
<ul>
<li>重新计算干预组与对照组的平衡协变量或协变量函数的权重</li>
</ul></li>
<li><p>半参数估计 (van der Vaart, 2000)</p>
<ul>
<li>离散型处理变量——使用潜在结果的期望产出 (平均值)</li>
<li>连续性处理变量——使用非参数估计</li>
</ul></li>
</ul>
<p>在上面的论述中，多数因果识别方法都是基于稳定性假设，即干预行为对干预组的影响是相同的。然而，在不同的环境中，一种干预行为的效果可能并不相同。在估计异质性的因果效应时，使用机器学习的方法可能有助于解决上述问题，例如因果树
(causal trees)、BART (Bayesian Additive Regression Trees)。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://fgzfgz.github.io">FGZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://fgzfgz.github.io/posts/56058/">https://fgzfgz.github.io/posts/56058/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">转载请联系作者，并注明文章来源 <a href="https://fgzfgz.github.io" target="_blank">https://fgzfgz.github.io</a></span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%90%88%E6%88%90%E6%8E%A7%E5%88%B6%E6%B3%95/">合成控制法</a><a class="post-meta__tags" href="/tags/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD/">因果推断</a><a class="post-meta__tags" href="/tags/%E8%A7%86%E9%A2%91/">视频</a><a class="post-meta__tags" href="/tags/%E5%9B%9E%E5%BD%92%E6%B3%95/">回归法</a><a class="post-meta__tags" href="/tags/%E5%80%BE%E5%90%91%E5%BE%97%E5%88%86%E5%8C%B9%E9%85%8D/">倾向得分匹配</a><a class="post-meta__tags" href="/tags/%E5%B7%A5%E5%85%B7%E5%8F%98%E9%87%8F%E6%B3%95/">工具变量法</a><a class="post-meta__tags" href="/tags/%E5%9B%BA%E5%AE%9A%E6%95%88%E5%BA%94/">固定效应</a><a class="post-meta__tags" href="/tags/%E5%8F%8C%E9%87%8D%E5%B7%AE%E5%88%86%E6%B3%95/">双重差分法</a></div><div class="post_share"><div class="social-share" data-image="/img/topimage.jpg" data-sites="wechat,qq,weibo,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/28394/" title="资源分享｜年鉴、统计资料下载"><img class="cover" src="/img/topimage.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">资源分享｜年鉴、统计资料下载</div></div></a></div><div class="next-post pull-right"><a href="/posts/29263/" title="数据清洗｜Stata 复合双引号的使用"><img class="cover" src="/img/topimage.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">数据清洗｜Stata 复合双引号的使用</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/48726/" title="模型｜合成控制法 (Synthetic Control Method, SCM)"><img class="cover" src="/img/topimage.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-11</div><div class="title">模型｜合成控制法 (Synthetic Control Method, SCM)</div></div></a></div><div><a href="/posts/19698/" title="因果推断｜回归猴子：从回归到因果推断"><img class="cover" src="/img/topimage.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-05</div><div class="title">因果推断｜回归猴子：从回归到因果推断</div></div></a></div><div><a href="/posts/15842/" title="数据清洗专题视频｜CFPS隔代照料问题的讨论"><img class="cover" src="/img/topimage.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-05</div><div class="title">数据清洗专题视频｜CFPS隔代照料问题的讨论</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">FGZ</div><div class="author-info__description">道阻且长，行则将至</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">91</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/455889108"><i class="fas fa-brands fa-bilibili"></i><span>  关      注</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E8%AF%86%E5%88%AB%E7%AD%96%E7%95%A5"><span class="toc-text">一、识别策略</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BD%95%E9%9C%80%E8%A6%81%E5%9B%A0%E6%9E%9C%E8%AF%86%E5%88%AB"><span class="toc-text">1. 为何需要因果识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90%E8%A6%81%E4%BB%B6"><span class="toc-text">2. 基本构成要件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%9C%A8%E7%BB%93%E6%9E%9C"><span class="toc-text">2.1 潜在结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%B3%E5%AE%9A%E6%80%A7%E5%81%87%E8%AE%BE"><span class="toc-text">2.2 稳定性假设</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E6%9C%BA%E5%88%B6"><span class="toc-text">2.3 分配机制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E9%9A%8F%E6%9C%BA%E5%8C%96%E5%AE%9E%E9%AA%8C%E4%B8%8E%E5%9B%9E%E5%BD%92%E6%B3%95"><span class="toc-text">二、随机化实验与回归法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%8C%96%E5%AE%9E%E9%AA%8C"><span class="toc-text">1. 随机化实验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E6%B3%95"><span class="toc-text">2. 回归法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E5%8C%B9%E9%85%8D%E6%B3%95"><span class="toc-text">三、匹配法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E5%81%87%E8%AE%BE"><span class="toc-text">1. 前提假设</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%B0%E8%AE%A1%E6%AD%A5%E9%AA%A4"><span class="toc-text">2. 估计步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E7%9B%B8%E4%BC%BC%E6%80%A7"><span class="toc-text">2.1 定义相似性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%96%BD%E5%8C%B9%E9%85%8D"><span class="toc-text">2.2 实施匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E4%BB%B7%E5%8C%B9%E9%85%8D%E6%95%88%E6%9E%9C"><span class="toc-text">2.3 评价匹配效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%B0%E8%AE%A1%E5%9B%A0%E6%9E%9C%E6%95%88%E5%BA%94"><span class="toc-text">2.4 估计因果效应</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E5%B7%A5%E5%85%B7%E5%8F%98%E9%87%8F%E6%B3%95"><span class="toc-text">四、工具变量法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E5%9B%BA%E5%AE%9A%E6%95%88%E5%BA%94%E5%8F%8C%E9%87%8D%E5%B7%AE%E5%88%86%E4%B8%8E%E5%90%88%E6%88%90%E6%8E%A7%E5%88%B6"><span class="toc-text">五、固定效应、双重差分与合成控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E6%95%88%E5%BA%94%E6%B3%95"><span class="toc-text">1. 固定效应法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E9%87%8D%E5%B7%AE%E5%88%86%E6%B3%95"><span class="toc-text">2. 双重差分法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%81%87%E8%AE%BE"><span class="toc-text">2.1 基本假设：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E9%AA%8C"><span class="toc-text">2.2 检验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%B3%E8%A1%8C%E8%B6%8B%E5%8A%BF%E6%A3%80%E9%AA%8C"><span class="toc-text">2.2.1 平行趋势检验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E6%85%B0%E5%89%82%E6%A3%80%E9%AA%8C"><span class="toc-text">2.2.2 安慰剂检验</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E6%88%90%E6%8E%A7%E5%88%B6%E6%B3%95"><span class="toc-text">3. 合成控制法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%81%87%E8%AE%BE-1"><span class="toc-text">3.1 基本假设：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-text">3.2 例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E9%AA%8C-1"><span class="toc-text">3.3 检验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E5%90%88%E6%88%90%E6%8E%A7%E5%88%B6%E6%B3%95"><span class="toc-text">4. 回归合成控制法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E6%96%AD%E7%82%B9%E5%9B%9E%E5%BD%92"><span class="toc-text">六、断点回归</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%81%87%E8%AE%BE"><span class="toc-text">1. 适用条件与假设</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="toc-text">1.1 使用条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%87%E8%AE%BE"><span class="toc-text">1.2 假设</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-text">2. 类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%AD%E7%82%B9%E5%9B%9E%E5%BD%92%E7%9A%84%E5%9B%9B%E4%B8%AA%E5%85%B3%E9%94%AE%E7%82%B9"><span class="toc-text">3. 使用断点回归的四个关键点：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-1"><span class="toc-text">4. 例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E9%AA%8C-2"><span class="toc-text">5. 检验</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="toc-text">七、其他方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%80%BC%E5%A4%84%E7%90%86%E5%8F%98%E9%87%8F%E7%9A%84%E5%9B%A0%E6%9E%9C%E6%95%88%E5%BA%94%E4%BC%B0%E8%AE%A1"><span class="toc-text">1. 多值处理变量的因果效应估计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E4%BC%9A%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E5%9B%A0%E6%9E%9C%E6%95%88%E5%BA%94%E8%AF%86%E5%88%AB"><span class="toc-text">2. 社会网络中的因果效应识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0"><span class="toc-text">3. 机器学习</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最近更新</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1706/" title="实证｜双重差分法的安慰剂检验"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="实证｜双重差分法的安慰剂检验"/></a><div class="content"><a class="title" href="/posts/1706/" title="实证｜双重差分法的安慰剂检验">实证｜双重差分法的安慰剂检验</a><time datetime="2025-07-27T07:32:05.290Z" title="更新于 2025-07-27 15:32">2025-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/22302/" title="微观｜第6章：产品市场理论—完全竞争市场"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微观｜第6章：产品市场理论—完全竞争市场"/></a><div class="content"><a class="title" href="/posts/22302/" title="微观｜第6章：产品市场理论—完全竞争市场">微观｜第6章：产品市场理论—完全竞争市场</a><time datetime="2025-07-27T05:43:30.356Z" title="更新于 2025-07-27 13:43">2025-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9426/" title="微观｜第7章：产品市场理论—不完全竞争市场"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微观｜第7章：产品市场理论—不完全竞争市场"/></a><div class="content"><a class="title" href="/posts/9426/" title="微观｜第7章：产品市场理论—不完全竞争市场">微观｜第7章：产品市场理论—不完全竞争市场</a><time datetime="2025-07-27T05:42:47.161Z" title="更新于 2025-07-27 13:42">2025-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/15451/" title="数据清洗｜生成平衡面板数据"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜生成平衡面板数据"/></a><div class="content"><a class="title" href="/posts/15451/" title="数据清洗｜生成平衡面板数据">数据清洗｜生成平衡面板数据</a><time datetime="2025-07-26T15:04:20.622Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/64269/" title="数据清洗｜其他样本管理"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜其他样本管理"/></a><div class="content"><a class="title" href="/posts/64269/" title="数据清洗｜其他样本管理">数据清洗｜其他样本管理</a><time datetime="2025-07-26T15:04:18.818Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/15500/" title="数据清洗｜命令安装、查询"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜命令安装、查询"/></a><div class="content"><a class="title" href="/posts/15500/" title="数据清洗｜命令安装、查询">数据清洗｜命令安装、查询</a><time datetime="2025-07-26T15:04:16.850Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/42980/" title="数据清洗｜家庭分户问题解决思路与代码"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜家庭分户问题解决思路与代码"/></a><div class="content"><a class="title" href="/posts/42980/" title="数据清洗｜家庭分户问题解决思路与代码">数据清洗｜家庭分户问题解决思路与代码</a><time datetime="2025-07-26T15:04:15.014Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/23887/" title="数据清洗｜计算同侪效应"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜计算同侪效应"/></a><div class="content"><a class="title" href="/posts/23887/" title="数据清洗｜计算同侪效应">数据清洗｜计算同侪效应</a><time datetime="2025-07-26T15:04:13.259Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/17580/" title="数据清洗｜变量滞后与提前"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜变量滞后与提前"/></a><div class="content"><a class="title" href="/posts/17580/" title="数据清洗｜变量滞后与提前">数据清洗｜变量滞后与提前</a><time datetime="2025-07-26T15:04:11.156Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9680/" title="数据清洗｜变量生成与替换"><img src="/img/topimage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据清洗｜变量生成与替换"/></a><div class="content"><a class="title" href="/posts/9680/" title="数据清洗｜变量生成与替换">数据清洗｜变量生成与替换</a><time datetime="2025-07-26T15:04:08.989Z" title="更新于 2025-07-26 23:04">2025-07-26</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/topimage.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By FGZ</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'jsVAsGoLh4uzI2G5L4KNVxy4-gzGzoHsz',
      appKey: 'O0Kgf1B5rJVcWBvt1vVvsRQd',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.sukap.cn/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>